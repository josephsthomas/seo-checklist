# AI Readability Checker — Export & Reporting Requirements

## 1. Export Formats

### 1.1 PDF Report

#### 1.1.1 Generation Technology

Use the existing portal PDF stack: **jsPDF** + **jspdf-autotable**.

#### 1.1.2 Report Structure

**Page 1: Cover Page**
- Portal logo (top-left)
- Report title: "AI Readability Analysis Report"
- Analyzed URL (or filename)
- Analysis date and time
- Overall score (large, color-coded) with grade
- Generated by: user name and organization (from profile)
- Optional: client logo and company name (user-configurable)

**Page 2: Executive Summary**
- One-paragraph summary of findings
- Overall score with grade explanation
- Category scores table (5 categories with scores and grades)
- Key statistics: total checks run, passed, warnings, failures
- Top 3 quick-win recommendations highlighted

**Page 3-4: Category Breakdown**
- One section per category (Content Structure, Content Clarity, Technical Accessibility, Metadata & Schema, AI-Specific Signals)
- Each section: category name, score, grade, progress bar visualization
- List of checks within category: status icon, title, brief result
- Failed/warning checks include the recommendation inline

**Page 5: LLM Rendering Summary**
- Coverage metrics table: LLM name, content coverage %, heading coverage %, entity coverage %, usefulness score
- Key differences noted between LLMs (2-3 bullet points per LLM)
- Note: full LLM extractions are too verbose for PDF; summary only

**Page 6-7: Recommendations**
- Prioritized recommendation list
- Each item: priority badge, title, description, category, effort level, estimated impact
- Grouped by: Quick Wins, Structural, Content, Technical
- Code snippets included for top 5 technical recommendations

**Page 8: GEO Strategic Brief (Optional — toggle on by default)**
- One-page summary targeted at GEO/AI search optimization stakeholders
- Citation Likelihood score with explanation and key contributing factors
- AI Crawler Access matrix (per-crawler allow/block status from TA-02/TA-03)
- Top 3 AI-Specific Signals findings (from AS-01 through AS-10)
- Quotable Passages assessment (from AS-05)
- 2-3 bullet points: "What to prioritize for AI search visibility"
- This page addresses the GEO Specialist persona (Priya) and differentiates the report from generic SEO tools

**Page 9: Methodology**
- Scoring methodology explanation (weights per category)
- List of 50 checks with brief descriptions
- LLM models and versions used
- Disclaimer about AI-generated analysis portions
- Date and version of the analysis engine

**Footer (all pages):**
- Page number
- "Generated by Content Strategy Portal — AI Readability Checker"
- Generation timestamp

#### 1.1.3 PDF Styling

| Element | Style |
|---|---|
| Font | Helvetica (jsPDF built-in) |
| Primary color | Teal (#14b8a6) for headers and accents |
| Score colors | Emerald (A), Teal (B), Amber (C), Orange (D), Red (F) |
| Tables | jspdf-autotable with alternating row colors |
| Page size | A4 (210mm x 297mm) |
| Margins | 20mm all sides |
| Header | Tool name + date on each page |

#### 1.1.4 Customization Options

| Option | Default | User-Configurable |
|---|---|---|
| Report title | "AI Readability Analysis Report" | Yes — free text |
| Client name | Empty | Yes — free text |
| Client logo | None | Yes — image upload (stored in user settings) |
| Include LLM summary | Yes | Yes — toggle |
| Include GEO Strategic Brief | Yes | Yes — toggle |
| Include methodology | Yes | Yes — toggle |
| Include code snippets | Yes | Yes — toggle |

#### 1.1.5 PDF Export Preview

Before generating and downloading the PDF, the system SHALL display a **preview modal**:
- Modal shows a paginated preview of the PDF layout using the selected customization options
- User can toggle customization options (LLM summary, GEO brief, methodology, code snippets) and see the preview update
- "Generate & Download" button initiates the PDF creation
- "Cancel" returns to the dashboard without generating
- Preview renders a lightweight HTML representation (not a full jsPDF render) for performance

---

### 1.2 JSON Export

#### 1.2.1 Schema

The JSON export SHALL include the complete analysis data:

```json
{
  "exportVersion": "1.0",
  "exportDate": "2026-02-17T10:30:00Z",
  "tool": "ai-readability-checker",
  "toolVersion": "1.0.0",

  "input": {
    "method": "url",
    "url": "https://example.com/page",
    "filename": null,
    "analyzedAt": "2026-02-17T10:28:00Z"
  },

  "pageMetadata": {
    "title": "Page Title",
    "description": "Page description",
    "canonicalUrl": "https://example.com/page",
    "language": "en",
    "httpStatus": 200,
    "contentLength": 45678,
    "lastModified": "2026-01-15T10:00:00Z",
    "robotsDirectives": {
      "index": true,
      "follow": true,
      "noai": false
    }
  },

  "scores": {
    "overall": 85,
    "grade": "A",
    "categories": {
      "contentStructure": { "score": 90, "grade": "A", "weight": 0.20 },
      "contentClarity": { "score": 82, "grade": "B+", "weight": 0.25 },
      "technicalAccessibility": { "score": 88, "grade": "B+", "weight": 0.20 },
      "metadataSchema": { "score": 78, "grade": "C+", "weight": 0.15 },
      "aiSpecificSignals": { "score": 80, "grade": "B", "weight": 0.20 }
    }
  },

  "issueSummary": {
    "critical": 0,
    "high": 2,
    "medium": 5,
    "low": 3,
    "passed": 40,
    "total": 50
  },

  "checkResults": [
    {
      "id": "CS-01",
      "category": "contentStructure",
      "title": "Single H1 present",
      "status": "pass",
      "severity": "high",
      "details": "Found exactly one H1 element.",
      "affectedElements": [],
      "recommendation": null
    }
  ],

  "llmExtractions": {
    "claude": {
      "model": "claude-sonnet-4-5-20250929",
      "status": "success",
      "extractedTitle": "...",
      "extractedDescription": "...",
      "primaryTopic": "...",
      "headings": [],
      "mainContent": "...",
      "entities": [],
      "unprocessableContent": [],
      "usefulnessScore": 8,
      "usefulnessExplanation": "...",
      "processingTimeMs": 3200
    },
    "openai": { },
    "gemini": { }
  },

  "recommendations": [
    {
      "id": "rec-001",
      "title": "Add meta description",
      "description": "...",
      "category": "metadataSchema",
      "priority": "high",
      "effort": "quick",
      "estimatedImpact": 5,
      "group": "quick-wins",
      "source": "rule",
      "codeSnippet": {
        "before": "<head>\n  <title>...</title>\n</head>",
        "after": "<head>\n  <title>...</title>\n  <meta name=\"description\" content=\"...\">\n</head>",
        "language": "html"
      }
    }
  ],

  "aiAnalysis": {
    "contentSummary": "...",
    "qualityAssessment": "...",
    "citationWorthiness": 75,
    "readabilityIssues": [],
    "aiRecommendations": []
  }
}
```

#### 1.2.2 Filename Convention

`readability-{url-slug}-{YYYY-MM-DD-HHmm}.json`

Example: `readability-example-com-page-2026-02-17-1030.json`

---

### 1.3 Excel Export (Post-MVP)

For future consideration: Excel export using ExcelJS (already installed) with:
- Summary sheet (scores, metadata)
- Checks sheet (all 50 checks with results)
- Recommendations sheet
- LLM comparison sheet

---

## 2. Sharing

### 2.1 Shareable Link Generation

**Flow:**
1. User clicks "Share" button on results dashboard
2. System generates a UUID share token
3. Token and expiry date saved to the analysis document in Firestore
4. URL constructed: `{portal-domain}/shared/readability/{shareToken}`
5. URL copied to clipboard automatically
6. Toast notification: "Share link copied to clipboard"

**Share Settings:**
| Setting | Default | Options |
|---|---|---|
| Expiry | 30 days | 7 days, 30 days, 90 days, Never |
| Access level | Read-only | Read-only (only option for MVP) |

> **Note:** The 'Never' expiry option should display a warning: "Non-expiring links remain accessible indefinitely. Consider 90-day expiry for sensitive analyses."

### 2.2 Shared View

The shared view (`/shared/readability/:shareToken`) SHALL:
- Display without authentication
- Show: overall score, category breakdown, LLM coverage summary, top recommendations
- Show: LLM coverage summary table (Content%, Headings%, Entities%, Usefulness per LLM). NOT show: full LLM extraction text content or history
- Include a **"Download PDF Report"** button that generates and downloads a PDF using the same generation logic as the authenticated export (default customization options; no client logo or custom title). This enables shared link recipients to save and forward the analysis.
- Include portal branding and a "Create your own analysis" CTA
- Show expiry date: "This shared analysis expires on [date]"
- Handle expired links with a clear "This link has expired" message
- Include a brief "About This Report" section explaining the AI Readability score methodology in 2-3 sentences for first-time viewers
- De-emphasize the expiry date (useful for the sharer, not the recipient)
- Support system-theme-aware dark/light mode via `prefers-color-scheme` (ThemeContext is unavailable on public routes)

### 2.3 Revoking Shared Links

- User can revoke a shared link from the analysis detail view
- Revoking sets `isShared: false` and clears `shareToken`
- Previously shared URLs return "This analysis is no longer shared"

---

## 3. Export Hub Integration

### 3.1 Registration

The AI Readability Checker SHALL register its exports in the portal's Export Hub.

**Export Hub Entry:**
```javascript
{
  tool: 'readability',
  toolName: 'AI Readability Checker',
  icon: ScanEye,
  color: 'teal',
  items: analyses.map(a => ({
    id: a.id,
    title: a.url || a.filename,
    subtitle: `Score: ${a.overallScore} (${a.grade})`,
    date: a.createdAt,
    formats: ['pdf', 'json'],
    onExport: (format) => exportAnalysis(a.id, format)
  }))
}
```

### 3.2 Batch Export

- Users can select multiple analyses in the Export Hub
- Batch export creates a ZIP file containing individual PDF or JSON files
- ZIP filename: `readability-export-{YYYY-MM-DD}.zip`
- Uses existing `jszip` dependency

---

## 4. Print Optimization

### 4.1 Print Stylesheet

The results dashboard SHALL include print-optimized CSS:

```css
@media print {
  /* Hide non-essential elements */
  nav, .btn, .tabs, footer, .toast { display: none; }

  /* Show all accordion content expanded */
  .accordion-content { display: block !important; height: auto !important; }

  /* Ensure charts print */
  canvas { max-width: 100%; }

  /* Page breaks */
  .category-section { page-break-inside: avoid; }
  .recommendation-card { page-break-inside: avoid; }

  /* Simplify colors for print */
  * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
```

### 4.2 Keyboard Shortcut

Ctrl+P / Cmd+P SHALL trigger the browser's native print dialog with the optimized layout.

---

## 5. Clipboard Operations

### 5.1 Copy Actions

| Element | Copy Behavior | Notification |
|---|---|---|
| Share link | URL copied as text | Toast: "Share link copied" |
| Code snippet (after) | HTML/JSON code copied | Toast: "Code copied to clipboard" |
| Overall score | "AI Readability Score: 85/100 (A)" copied | Toast: "Score copied" |
| Individual check result | Check title + status + detail | Toast: "Check result copied" |

### 5.2 Implementation

Use `navigator.clipboard.writeText()` with fallback to `document.execCommand('copy')` for older browsers. Show toast notification on success, error toast on failure.

---

*Document Version: 1.3*
*Created: 2026-02-17*
*Last Updated: 2026-02-17*
*Status: Draft — v1.3: GEO Strategic Brief page added to PDF (E-GEO-10), PDF preview modal added (E-UX-04), shared view PDF download added (E-OPS-13)*
